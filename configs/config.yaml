# JsFIndcrack 默认配置
# 配置文件路径: ~/.jsfindcrack/config.yaml 或 ./config/config.yaml

# 爬取配置
crawl:
  # 爬取深度 (1-10)
  depth: 2

  # 页面等待时间(秒)
  wait_time: 3

  # 静态爬取并发线程数
  max_workers: 2

  # Playwright标签页数量
  playwright_tabs: 4

  # 无头模式
  headless: true

  # 默认爬取模式 (all/static/dynamic)
  mode: "all"

  # 是否允许跨域爬取 (默认true,false时仅爬取同域名链接)
  allow_cross_domain: true

# 相似度分析配置
similarity:
  # 是否启用相似度检测
  enabled: true

  # 相似度阈值 (0.0-1.0)
  threshold: 0.8

  # 相似度分析并发数
  workers: 8

# 日志配置
logging:
  # 日志级别 (trace/debug/info/warn/error/fatal/panic)
  level: "info"

  # 日志输出目录
  log_dir: "logs"

  # 日志轮转配置
  rotation:
    max_size: 10    # MB
    max_backups: 3  # 保留文件数
    max_age: 28     # 天
    compress: true

# 输出配置
output:
  # 输出根目录
  base_dir: "output"

  # 是否按域名分离
  domain_separation: true

# 反混淆配置
deobfuscation:
  # 是否自动反混淆
  auto: true

  # webcrack命令路径
  webcrack_path: "webcrack"

  # 超时时间(分钟)
  timeout: 5

# 断点续爬配置
checkpoint:
  # 是否启用断点续爬
  enabled: true

  # 检查点保存频率(处理文件数)
  save_frequency: 10

  # 检查点文件目录
  checkpoint_dir: "checkpoints"

# 批量处理配置
batch:
  # 是否在错误时继续
  continue_on_error: true



# 性能配置
performance:
  # 最大文件大小(MB)
  max_file_size: 50

  # 并发下载超时(秒)
  download_timeout: 30

  # HTTP请求超时(秒)
  http_timeout: 30

# 资源优化配置 (自适应标签页池)
# 动态爬取模式会根据系统资源和待爬URL数量自适应调整标签页数
resource:
  # 安全保留内存(MB) - 系统预留,不用于标签页计算
  # 建议范围: 512-2048MB
  # 低内存环境(<4GB): 512MB
  # 标准环境(4-8GB): 1024MB
  # 高内存环境(>16GB): 2048MB
  safety_reserve_memory: 1024  # 默认1GB

  # 安全阈值(MB) - 可用内存低于此值暂停创建标签页
  # 建议范围: 200-1000MB
  # 触发警告日志: "可用内存不足,标签页创建受限"
  # 低内存环境: 200-300MB
  # 标准环境: 500MB
  # 高内存环境: 1000MB
  safety_threshold: 500        # 默认500MB

  # CPU负载阈值(%) - 负载超过此值暂停创建标签页
  # 使用gopsutil获取真实的系统CPU使用率
  # 设置为 >= 200 可以禁用CPU检查(推荐)
  # 建议范围: 50-95 (启用检查) 或 200+ (禁用检查)
  # 较低值(50-70): 更保守,减少系统压力
  # 较高值(80-95): 更激进,提升爬取速度
  cpu_load_threshold: 200      # 200表示禁用CPU检查

  # 绝对最大标签页数 - 硬上限,避免过度消耗
  # 建议范围: 1-32
  # 低内存环境: 2-4
  # 标准环境: 8-16
  # 高性能环境: 16-32
  # 注意: 每个标签页平均消耗100MB内存
  max_tabs_limit: 16           # 默认16

# 渐进式降级策略 (自动触发)
# - 可用内存 < 500MB: 暂停创建新标签页 (警告日志)
# - 可用内存 < 300MB: 主动缩减至当前标签页数的50% (警告日志)
# - 可用内存 < 200MB: 紧急缩减至1个标签页 (错误日志)
